float32[] state
float32[] plan